<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">
<head >
    <meta charset="UTF-8">
    <title>PCS - Calendar</title>

    <link th:href="@{/vendor/jsgantt-improved/dist/jsgantt.css}" rel="stylesheet" type="text/css"/>
</head>
<body class="sb-nav-fixed">
<div class="container-fluid px-4" layout:fragment="content">
    <div style="position:relative" class="gantt" id="GanttChartDIV"></div>
</div>
<div th:fragment="scripts">
    <script th:src="@{/vendor/jsgantt-improved/dist/jsgantt.js}" type="text/javascript"></script>

    <script th:inline="javascript">

        let ganttData = [[${ganttData}]];
        let ganttDataJsonArray = JSON.parse(ganttData);

        console.log("ganttData = " + ganttData);

        let ganttChart = new JSGantt.GanttChart(document.getElementById('GanttChartDIV'), 'day');

        // configure ganttChart columns
        ganttChart.setShowRes(0);
        ganttChart.setShowDur(0);
        ganttChart.setShowComp(0);
        ganttChart.setShowStartDate(0);
        ganttChart.setShowEndDate(0);
        ganttChart.setShowPlanStartDate(0);
        ganttChart.setShowPlanEndDate(0);
        ganttChart.setShowCost(0);
        ganttChart.setShowDeps(0);

        // add vertical scroll
        ganttChart.setTotalHeight('300px')

        // configure ganttChart date columns width
        ganttChart.setDayColWidth(22);

        // configure ganttChart date format
        ganttChart.setDayMajorDateDisplayFormat('yyyy.mon.dd');
        ganttChart.setDateTaskTableDisplayFormat('yyyy.mon.dd');

        // configure ganttChart tooltip information
        ganttChart.setShowTaskInfoRes(0)

        // add data to chart
        $.each(ganttDataJsonArray, function(index, data) {
           ganttChart.AddTaskItemObject(data);
        });

        /*ganttChart.setEventClickRow(function (task) {
            alert(task);
        });*/

        ganttChart.setTotalHeight(document.documentElement.clientWidth);

        ganttChart.Draw();
    </script>
</div>
</body>
</html>